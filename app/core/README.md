# Core Infrastructure (`app/core/`)

アプリケーションの技術的な基盤（インフラストラクチャ）となるコードを管理するディレクトリです。
ビジネスロジックやWebインターフェースに依存しない、最も低レイヤーの共有リソースを提供します。

## 📁 内部ファイルの役割

### `database.py`
**データベース接続とORM設定の中核**です。SQLAlchemyを使用しています。

主な責務は以下の通りです：
1.  **エンジンの作成 (`engine`)**:
    * 環境変数 (`DB_USER`, `DB_PASSWORD` 等) を読み込み、MySQLデータベースへの接続を確立します。
2.  **セッションファクトリの定義 (`SessionLocal`)**:
    * アプリケーションの各処でデータベース操作を行うための「セッション」を作成するクラスです。
    * リクエストごとに新しいセッションを生成し、処理終了後に閉じるための基盤となります。
3.  **基底モデルの定義 (`Base`)**:
    * `app/models/` 配下の全てのモデルクラスが継承すべき基底クラス (`Declarative Base`) を提供します。
    * これにより、Pythonのクラス定義が自動的にデータベースのテーブル構造にマッピングされます。
4.  **依存性注入ユーティリティ (`get_db`)**:
    * FastAPIやFlaskのルート関数などで、安全にDBセッションを取得・破棄するためのジェネレータ関数です。

## 🔗 他モジュールとの関係性

このディレクトリは、アプリケーションの依存関係の**最下層**に位置します。

* **⬅️ Used by `app/models/`**:
    * モデル定義のために `Base` クラスを提供します。
* **⬅️ Used by `app/crud/`**:
    * データベース操作を実行するために `SessionLocal` や `get_db` を提供します。
* **⬅️ Used by `app/services/`**:
    * ビジネスロジック内でトランザクション管理が必要な場合に利用されます。

## 🛠 コードの設計方針

* **フレームワーク非依存（に近い設計）**:
    * Flask固有の拡張機能（`Flask-SQLAlchemy`）に過度に依存せず、純粋なSQLAlchemyのパターンを採用しています。
    * これにより、Webアプリケーション以外（バッチ処理やCLIツールなど）からもデータベース機能を容易に再利用できるようになっています。